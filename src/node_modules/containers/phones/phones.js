import React, {Component} from 'react'
import {connect} from 'react-redux'
import {fetchPhones, loadMorePhones} from 'actions/actions'
import {getPhones} from 'selectors'
import {Link} from "react-router-dom";
import * as R from "ramda";


class Phones extends Component {

    componentDidMount () {
        this.props.fetchPhones()
    }
    renderPhone (phone, index){
        const shortDescription = `${R.take(60, phone.description)}...`

        return(
            <div key={index}>
                <div>
                    <img className="phone-img" src={phone.image} alt={phone.name}/>
                </div>
                <div className="caption">
                    <Link to={`/phones/${phone.id}`} className="title">{phone.name}</Link>
                    <p className="price">{phone.price}</p>
                    <p>{shortDescription}</p>
                    <p className="itemBtn">
                        <button>Buy now</button>
                    </p>
                    <Link to={`/phones/${phone.id}`} >More info</Link>
                </div>
            </div>
        )
}
    render () {
        const phones = this.props.phones;
        console.log(this.props);
        return (
            <div>
            <div className="phonesList">{phones.map((phone, index)=>this.renderPhone(phone, index))}</div>
             <button onClick={loadMorePhones}>Load more</button>
            </div>
        )
    }
}
const mapStateToProps = state => {
    return {
        phones: getPhones(state)
    }
}

const mapDispatchToProps = {
    fetchPhones,
    loadMorePhones
}

export default connect(mapStateToProps, mapDispatchToProps)(Phones)
